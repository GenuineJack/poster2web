<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SiteWeave - Transform Documents into Beautiful Websites</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 16 16%22><text y=%221em%22 font-size=%2216%22>üß∂</text></svg>">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- Set PDF.js worker -->
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js';
    </script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Auto-save Indicator -->
    <div id="autosaveIndicator" class="autosave-indicator">üíæ Saved</div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <div class="main-content">
        <!-- UPLOAD SCREEN -->
        <div id="uploadScreen" class="screen active">
            <div class="header-icons">
                <button class="icon-button" onclick="showInfo()" title="About SiteWeave" aria-label="About SiteWeave">
                    <span>‚ÑπÔ∏è</span>
                </button>
                <button class="icon-button" onclick="goHome()" title="Home" aria-label="Home">
                    <span>üè†</span>
                </button>
            </div>

            <div style="max-width: 1200px; margin: 0 auto; padding: 64px 20px 40px;">
                <!-- Enhanced Hero Section -->
                <header style="text-align: center; margin-bottom: 56px;">
                    <div style="display: inline-flex; align-items: center; background: linear-gradient(135deg, var(--primary) 0%, hsl(142 76% 45%) 100%); color: white; padding: 10px 28px; border-radius: 50px; font-size: 14px; font-weight: 600; margin-bottom: 32px; box-shadow: var(--shadow-md); border: 1px solid hsl(142 76% 86% / 0.5); backdrop-filter: blur(10px); letter-spacing: 0.025em;">
                        ‚ö° Single Page Websites in a Flash ‚ö°
                    </div>
                    <h1 style="font-size: clamp(48px, 8vw, 72px); font-weight: 900; margin-bottom: 24px; line-height: 1.1; letter-spacing: -0.02em; background: linear-gradient(135deg, var(--primary) 0%, hsl(142 76% 35%) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <span style="color: var(--primary); font-weight: 900;">SiteWeave</span>
                    </h1>
                    <p style="font-size: clamp(18px, 3vw, 24px); color: var(--muted-foreground); max-width: 600px; margin: 0 auto 48px; line-height: 1.5; font-weight: 400;">
                        Transform documents into beautiful websites in minutes.<br>
                        <strong style="color: var(--foreground); font-weight: 600;">No coding required.</strong>
                    </p>
                </header>

                <!-- Enhanced Upload Container -->
                <div class="upload-container">
                    <div id="dropZone" class="drop-zone">
                        <input type="file" id="fileInput" accept=".pdf,.pptx,.txt,.png,.jpg,.jpeg" aria-label="Choose file to upload">
                        <div class="upload-icon">
                            <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M12 15L12 3M12 3L16 7M12 3L8 7" stroke="url(#gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M2 17L2 19C2 20.1046 2.89543 21 4 21L20 21C21.1046 21 22 20.1046 22 19L22 17" stroke="url(#gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <defs>
                                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="var(--primary)"/>
                                        <stop offset="100%" stop-color="hsl(142 76% 45%)"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                        </div>
                        <h3 class="upload-title">Drop your content here</h3>
                        <p class="upload-subtitle">or click anywhere to browse your files</p>
                        <button type="button" class="browse-button" id="browseBtn">Start Weaving</button>
                    </div>
                    
                    <div class="upload-formats">
                        Supports PDF, PowerPoint (PPTX), Text (TXT), and image files
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="button" class="browse-button secondary" id="blankBtn">Create Blank Website</button>
                    </div>
                </div>

                <!-- Features Preview Section -->
                <section style="margin-top: 80px; text-align: center;">
                    <h2 style="font-size: 24px; font-weight: 700; color: var(--foreground); margin-bottom: 16px; letter-spacing: -0.01em;">
                        Why Choose SiteWeave?
                    </h2>
                    <p style="color: var(--muted-foreground); margin-bottom: 48px; font-size: 16px; max-width: 500px; margin-left: auto; margin-right: auto;">
                        The fastest way to turn your content into professional websites
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 32px; margin-top: 40px;">
                        <div style="text-align: center; padding: 24px; background: var(--card); border-radius: var(--radius-xl); border: 1px solid var(--border); box-shadow: var(--shadow-xs);">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--primary) 0%, hsl(142 76% 45%) 100%); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 24px;">
                                üöÄ
                            </div>
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--foreground);">Lightning Fast</h3>
                            <p style="color: var(--muted-foreground); font-size: 14px; line-height: 1.5;">Transform documents to websites in under 60 seconds</p>
                        </div>
                        
                        <div style="text-align: center; padding: 24px; background: var(--card); border-radius: var(--radius-xl); border: 1px solid var(--border); box-shadow: var(--shadow-xs);">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--primary) 0%, hsl(142 76% 45%) 100%); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 24px;">
                                üé®
                            </div>
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--foreground);">Beautiful Design</h3>
                            <p style="color: var(--muted-foreground); font-size: 14px; line-height: 1.5;">Professional templates with customizable themes</p>
                        </div>
                        
                        <div style="text-align: center; padding: 24px; background: var(--card); border-radius: var(--radius-xl); border: 1px solid var(--border); box-shadow: var(--shadow-xs);">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--primary) 0%, hsl(142 76% 45%) 100%); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 24px;">
                                üì±
                            </div>
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--foreground);">Mobile Ready</h3>
                            <p style="color: var(--muted-foreground); font-size: 14px; line-height: 1.5;">Responsive designs that work on all devices</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- LOADING SCREEN -->
        <div id="loadingScreen" class="screen loading-screen">
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <h2 id="loadingTitle" class="loading-title">Processing your file</h2>
                <p id="loadingMessage" class="loading-message">Extracting content and analyzing structure...</p>
            </div>
        </div>

        <!-- EDITOR SCREEN -->
        <div id="editorScreen" class="screen">
            <!-- Editor Header -->
            <div class="editor-header">
                <button id="backButton" class="back-button">
                    ‚Üê Back to Upload
                </button>
                <div class="editor-title">
                    <h1>SiteWeave Editor</h1>
                    <div id="pdfName" class="pdf-name">Document.pdf</div>
                </div>
                <div class="editor-actions">
                    <button class="btn btn-secondary" onclick="showPreviewModal()">
                        üëÅÔ∏è Preview
                    </button>
                    <button class="btn btn-primary" onclick="exportWebsite()">
                        üíæ Export
                    </button>
                    <button id="builderThemeToggle" class="btn btn-secondary" onclick="toggleBuilderDarkMode()">üåô Dark</button>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" data-tab="content" onclick="switchTab('content')">üìù Content</div>
                <div class="tab" data-tab="design" onclick="switchTab('design')">üé® Design</div>
                <div class="tab" data-tab="settings" onclick="switchTab('settings')">‚öôÔ∏è Settings</div>
            </div>

            <!-- Editor Content -->
            <div class="editor-content">
                <!-- Left Side: Form/Editor -->
                <div class="form-section">
                    <!-- Content Tab -->
                    <div id="contentTab" class="tab-content active">
                        <div class="sections-header">
                            <h2 class="sections-title">üìÑ Sections</h2>
                            <button class="btn btn-small btn-primary" onclick="addSection()">
                                + Add Section
                            </button>
                        </div>
                        <div id="sectionsContainer">
                            <!-- Sections will be dynamically added here -->
                        </div>
                    </div>

                    <!-- Design Tab -->
                    <div id="designTab" class="tab-content">
                        <h2 style="margin-bottom: 24px;">üé® Design Settings</h2>
                        
                        <!-- Color Scheme -->
                        <div class="form-group">
                            <label class="form-label">
                                Color Scheme
                                <span class="info-tooltip" title="Choose a predefined color scheme">‚ÑπÔ∏è</span>
                            </label>
                            <select id="colorScheme" class="form-select" onchange="updateColorScheme()">
                                <option value="growth-green">üå± Growth Green</option>
                                <option value="trust-blue">üíô Trust Blue</option>
                                <option value="premium-purple">üíú Premium Purple</option>
                                <option value="bold-red">‚ù§Ô∏è Bold Red</option>
                                <option value="modern-teal">ü¶ã Modern Teal</option>
                                <option value="sunset-orange">üåÖ Sunset Orange</option>
                                <option value="energy-yellow">‚ö° Energy Yellow</option>
                                <option value="professional-grey">üìò Professional Grey</option>
                                <option value="custom">üé® Custom</option>
                            </select>
                        </div>

                        <!-- Custom Colors -->
                        <div class="form-group">
                            <label class="form-label">Primary Color</label>
                            <div class="color-picker">
                                <input type="color" id="primaryColor" class="color-input" value="#16a34a">
                                <input type="text" id="primaryColorHex" class="form-input" value="#16a34a" style="width: 100px; margin-left: 12px;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Secondary Color</label>
                            <div class="color-picker">
                                <input type="color" id="secondaryColor" class="color-input" value="#15803d">
                                <input type="text" id="secondaryColorHex" class="form-input" value="#15803d" style="width: 100px; margin-left: 12px;">
                            </div>
                        </div>

                        <!-- Logo Upload -->
                        <div class="form-group">
                            <label class="form-label">
                                Logo
                                <span class="info-tooltip" title="Upload a logo for your website header">‚ÑπÔ∏è</span>
                            </label>
                            <label for="logoInput" class="file-upload-label" style="display: inline-block; padding: 10px 20px; background: var(--primary); color: white; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease; font-weight: 500;">
                                Choose Logo Image
                            </label>
                            <input type="file" id="logoInput" accept="image/*" onchange="handleLogoUpload(event)" style="display: none;">
                            <div id="logoPreview" style="margin-top: 12px;"></div>
                        </div>

                        <!-- Logo Size -->
                        <div class="form-group">
                            <label class="form-label">Logo Size</label>
                            <div class="range-group">
                                <input type="range" id="logoSize" class="range-input" min="60" max="200" value="120" oninput="updateLogoSize()">
                                <span id="logoSizeValue" class="range-value">120px</span>
                            </div>
                        </div>

                        <!-- Header Alignment -->
                        <div class="form-group">
                            <label class="form-label">Header Alignment</label>
                            <select id="headerAlignment" class="form-select">
                                <option value="left">Left</option>
                                <option value="center" selected>Center</option>
                                <option value="right">Right</option>
                            </select>
                        </div>

                        <!-- Typography -->
                        <div class="form-group">
                            <label class="form-label">Font Style</label>
                            <select id="fontStyle" class="form-select">
                                <option value="system" selected>System Default</option>
                                <option value="serif">Serif</option>
                                <option value="mono">Monospace</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Title Size</label>
                            <div class="range-group">
                                <input type="range" id="titleSize" class="range-input" min="24" max="60" value="32" oninput="updateTitleSize()">
                                <span id="titleSizeValue" class="range-value">32px</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Content Size</label>
                            <div class="range-group">
                                <input type="range" id="contentSize" class="range-input" min="14" max="24" value="16" oninput="updateContentSize()">
                                <span id="contentSizeValue" class="range-value">16px</span>
                            </div>
                        </div>

                        <!-- Layout Style -->
                        <div class="form-group">
                            <label class="form-label">
                                Layout Style
                                <span class="info-tooltip" title="Choose how sections are navigated">‚ÑπÔ∏è</span>
                            </label>
                            <select id="layoutStyle" class="form-select">
                                <option value="single" selected>Single Page (Traditional)</option>
                                <option value="sections">Section Navigation Bar</option>
                                <option value="menu">Hamburger Menu</option>
                            </select>
                        </div>
                    </div>

                    <!-- UPDATED Settings Tab -->
                    <div id="settingsTab" class="tab-content">
                        <h2 style="margin-bottom: 24px;">‚öôÔ∏è Settings</h2>
                        
                        <!-- Download Button Configuration -->
                        <div class="form-group">
                            <label class="form-label">
                                üìÑ Download Button
                                <span class="info-tooltip" title="Add a downloadable file for visitors">‚ÑπÔ∏è</span>
                            </label>
                            <div class="file-upload-section">
                                <label for="downloadFileInput" class="file-upload-label" style="display: inline-block; padding: 10px 20px; background: var(--primary); color: white; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease; font-weight: 500;">
                                    Choose File to Upload
                                </label>
                                <input type="file" id="downloadFileInput" onchange="handleDownloadFileUpload(event)" style="display: none;">
                                <div id="uploadedFileDisplay" class="uploaded-file-display" style="margin-top: 12px;">
                                    <div class="no-file-message">
                                        <span>üìé</span>
                                        <p>No file uploaded</p>
                                        <small>Upload a PDF or document for visitors to download</small>
                                    </div>
                                </div>
                                <input type="text" 
                                       id="downloadButtonText" 
                                       class="form-input" 
                                       placeholder="Button text (e.g., 'Download Brochure')" 
                                       style="margin-top: 12px;"
                                       onchange="updateButtonSettings()">
                            </div>
                        </div>

                        <!-- Contact Button Configuration -->
                        <div class="form-group">
                            <label class="form-label">
                                üìß Contact Button
                                <span class="info-tooltip" title="Add a contact button with URL or email">‚ÑπÔ∏è</span>
                            </label>
                            <input type="text" 
                                   id="contactButtonUrl" 
                                   class="form-input" 
                                   placeholder="Website URL or email address"
                                   onchange="updateButtonSettings()">
                            <input type="text" 
                                   id="contactButtonText" 
                                   class="form-input" 
                                   placeholder="Button text (e.g., 'Contact Us')" 
                                   style="margin-top: 8px;"
                                   onchange="updateButtonSettings()">
                            <span class="form-help">URLs and emails are automatically detected</span>
                        </div>

                        <!-- Button Preview -->
                        <div class="form-group">
                            <label class="form-label">Button Preview</label>
                            <div id="buttonPreview" style="padding: 16px; background: var(--muted); border-radius: var(--radius-lg); text-align: center;">
                                <p style="color: var(--muted-foreground); font-size: 14px;">Configure buttons above to see preview</p>
                            </div>
                        </div>

                        <!-- Analytics Code -->
                        <div class="form-group">
                            <label class="form-label">
                                üìä Analytics Code
                                <span class="info-tooltip" title="Add Google Analytics or other tracking code">‚ÑπÔ∏è</span>
                            </label>
                            <textarea id="analyticsCode" class="form-textarea" rows="4" placeholder="Paste your analytics tracking code here..."></textarea>
                            <span class="form-help">This code will be added to the &lt;head&gt; section of your exported website</span>
                        </div>
                    </div>
                </div>

                <!-- Right Side: Preview -->
                <div class="preview-section">
                    <div class="preview-container">
                        <div class="preview-header">
                            <div class="preview-dots">
                                <span class="preview-dot"></span>
                                <span class="preview-dot"></span>
                                <span class="preview-dot"></span>
                            </div>
                            <span class="preview-url">https://your-website.com</span>
                        </div>
                        <iframe id="websitePreview" class="preview-iframe" srcdoc="<h1>Loading preview...</h1>"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="modal">
        <div class="modal-content large">
            <button class="close-btn" onclick="closePreviewModal()">‚úï</button>
            <div class="modal-header">
                <h2 class="modal-title">Website Preview</h2>
                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button id="desktopBtn" class="btn btn-small btn-secondary active" onclick="setPreviewDevice('desktop')">üíª Desktop</button>
                    <button id="tabletHBtn" class="btn btn-small btn-secondary" onclick="setPreviewDevice('tablet-h')">üì± Tablet H</button>
                    <button id="tabletVBtn" class="btn btn-small btn-secondary" onclick="setPreviewDevice('tablet-v')">üì± Tablet V</button>
                    <button id="mobileBtn" class="btn btn-small btn-secondary" onclick="setPreviewDevice('mobile')">üì± Mobile</button>
                </div>
            </div>
            <div class="modal-body" style="display: flex; align-items: center; justify-content: center; padding: 40px;">
                <div id="previewFrame" class="preview-frame desktop">
                    <iframe id="fullPreview" style="width: 100%; height: 100%; border: none;" srcdoc="<h1>Loading preview...</h1>"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeExportModal()">‚úï</button>
            <h2 class="modal-title">Export Your Website</h2>
            <p class="modal-subtitle">Choose your preferred format</p>
            
            <div class="export-options">
                <label class="export-option">
                    <input type="radio" name="exportFormat" value="html" checked>
                    <div>
                        <div class="export-option-title">üìÑ HTML (Standalone)</div>
                        <div class="export-option-desc">Single HTML file ready to deploy anywhere</div>
                    </div>
                </label>
                
                <label class="export-option">
                    <input type="radio" name="exportFormat" value="react">
                    <div>
                        <div class="export-option-title">‚öõÔ∏è React Component</div>
                        <div class="export-option-desc">Modern React component with hooks</div>
                    </div>
                </label>
                
                <label class="export-option">
                    <input type="radio" name="exportFormat" value="nextjs">
                    <div>
                        <div class="export-option-title">‚ñ≤ Next.js Page</div>
                        <div class="export-option-desc">Server-side rendered with SEO optimization</div>
                    </div>
                </label>
            </div>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 24px;" onclick="downloadWebsite()">
                üíæ Download Website
            </button>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeInfoModal()">‚úï</button>
            <h2 class="modal-title">About SiteWeave</h2>
            <p style="line-height: 1.7; color: var(--muted-foreground); margin-top: 12px;">
                <strong>SiteWeave</strong> turns PDFs, PowerPoints, images, and text into polished, responsive single‚Äëpage websites.
                Drag, edit, and export to plain HTML, React, or Next.js‚Äîno frameworks required.
            </p>
            <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:14px; margin: 18px 0 6px;">
                <div style="background: var(--muted); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 12px 14px;">
                    <h4 style="margin:0 0 6px; color: var(--foreground);">üöÄ Fast Build</h4>
                    <div style="color: var(--muted-foreground);">Upload or start blank, then rearrange sections and content blocks with ease.</div>
                </div>
                <div style="background: var(--muted); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 12px 14px;">
                    <h4 style="margin:0 0 6px; color: var(--foreground);">üé® Design Controls</h4>
                    <div style="color: var(--muted-foreground);">Color schemes, logos, type sizing, and layout modes.</div>
                </div>
                <div style="background: var(--muted); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 12px 14px;">
                    <h4 style="margin:0 0 6px; color: var(--foreground);">üß∞ Exports</h4>
                    <div style="color: var(--muted-foreground);">Download clean HTML, a React component, or a Next.js page.</div>
                </div>
                <div style="background: var(--muted); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 12px 14px;">
                    <h4 style="margin:0 0 6px; color: var(--foreground);">üß© Add‚Äëons</h4>
                    <div style="color: var(--muted-foreground);">Custom buttons (email, phone, links, downloads), print‚Äëoptimized mode, and SEO tags.</div>
                </div>
            </div>
            <div style="display:flex; gap:12px; margin-top: 16px;">
                <button class="btn btn-primary" onclick="getStartedFromModal()" style="flex:1">Get Started</button>
                <button class="btn btn-secondary" onclick="closeInfoModal()">Close</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div>
                Made with üß° by <a href="https://www.linkedin.com/in/jackdemanche/" target="_blank" rel="noopener">Jack</a>
            </div>
        </div>
    </footer>

    <!-- Load JavaScript modules in correct order -->
    <script src="js/utils.js"></script>
    <script src="js/fileHandlers.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/export.js"></script>
    <script src="js/ocr.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
